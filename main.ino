#include <Arduino.h>
#include <Wire.h>
#include <ESP8266WiFi.h>
#include <ESP8266HTTPClient.h>
#include <ArduinoJson.h>
#include <Adafruit_GFX.h>
#include <Adafruit_SSD1306.h>
#include <time.h>
#include "secrets.h"
#include "Org_01.h"

// --- OLED ---
#define SCREEN_WIDTH 128
#define SCREEN_HEIGHT 64
#define OLED_RESET    -1
#define OLED_SDA D1
#define OLED_SCL D2
#define LED_PIN LED_BUILTIN
Adafruit_SSD1306 display(SCREEN_WIDTH, SCREEN_HEIGHT, &Wire, OLED_RESET);

// --- API ---
const char* apiURL = "https://pool.nerdminers.org/pool/pool.status";
String userApiURL = String("https://pool.nerdminers.org/users/") + WALLET_ADDR;

// --- Timers ---
unsigned long lastSwitch = 0;
const unsigned long pageInterval = 10000; // 10 seconds
int currentPage = 0;

// --- Stats ---
int usersCount = 0, workersCount = 0, idleCount = 0, disconnectedCount = 0;
String hashrate1m, hashrate5m, hashrate15m, hashrate1hr, hashrate6hr, hashrate1d, hashrate7d;
float diff = 0.0, accepted = 0, rejected = 0, bestshare = 0;
float SPS1m = 0, SPS5m = 0, SPS15m = 0, SPS1h = 0;

// --- User Stats ---
String u_hashrate1m, u_hashrate5m, u_hashrate1hr, u_hashrate1d, u_hashrate7d;
unsigned long u_lastshare = 0, u_authorised = 0;
int u_workers = 0;
float u_shares = 0.0, u_bestshare = 0.0, u_bestever = 0.0;

// --- String Splitter ---
String splitNumberUnit(String value) {
  int i = 0;
  while (i < value.length() && (isDigit(value[i]) || value[i] == '.')) {
    i++;
  }

  String number = value.substring(0, i);
  String unit = value.substring(i);

  if (unit.length() > 0) {
    return number + " " + unit;
  } else {
    return number;
  }
}

// --- Clock Page Animation ---
#define CLOCK_W 32
#define CLOCK_H 32
#define CLOCK_BYTES ((CLOCK_W * CLOCK_H) / 8)
#define CLOCK_FRAME_DELAY 42  // ms between frames, change if you want a faster/slower animation

const uint8_t PROGMEM frames_clock[][CLOCK_BYTES] = {
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,224,7,224,12,56,28,48,24,12,48,24,48,4,32,12,48,6,96,12,32,6,96,4,32,6,96,4,32,4,32,4,16,4,32,8,24,8,16,24,12,24,24,48,7,224,7,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,224,7,224,12,56,28,48,24,12,48,24,48,4,32,12,48,6,96,12,32,6,96,4,32,6,96,4,32,4,32,4,16,4,32,8,24,8,16,24,12,24,24,48,7,224,7,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,224,7,224,12,56,28,48,24,12,48,24,48,4,32,12,48,6,96,12,32,6,96,4,32,6,96,4,32,4,32,4,16,4,32,8,24,8,16,24,12,24,24,48,7,224,7,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,224,7,224,12,56,28,48,24,12,48,24,48,4,32,12,48,6,96,12,32,6,96,4,32,6,96,4,32,4,32,4,16,4,32,8,24,8,16,24,12,24,24,48,7,224,7,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,252,0,0,1,134,0,0,2,1,0,0,6,1,128,0,4,0,128,0,4,0,128,0,4,0,128,0,4,0,128,0,6,0,128,0,3,1,0,0,1,131,0,0,0,252,0,0,0,0,63,0,0,0,192,128,0,0,128,64,0,1,0,96,0,1,0,32,0,1,0,32,0,1,0,32,0,1,0,32,0,1,128,96,0,0,128,64,0,0,97,128,0,0,63,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,7,192,0,0,14,48,0,0,24,24,0,0,48,12,0,0,32,4,0,0,32,4,0,0,96,4,0,0,32,4,0,0,32,12,0,0,48,8,0,0,24,24,0,0,15,224,0,0,1,128,0,0,0,0,0,0,0,0,0,0,1,128,0,0,7,240,0,0,24,24,0,0,16,12,0,0,48,4,0,0,32,4,0,0,32,4,0,0,32,4,0,0,32,4,0,0,16,12,0,0,24,24,0,0,14,48,0,0,3,224,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,60,0,0,0,231,0,0,1,129,128,0,3,0,128,0,2,0,64,0,2,0,64,0,6,0,64,0,2,0,64,0,2,0,192,0,3,0,128,0,1,129,128,0,0,255,0,0,0,56,0,0,28,0,0,0,255,0,0,1,129,128,0,1,0,192,0,3,0,64,0,2,0,64,0,2,0,64,0,2,0,64,0,2,0,64,0,1,0,192,0,1,129,128,0,0,231,0,0,0,124,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0,0,0,31,192,0,0,48,96,0,0,64,48,0,0,192,16,0,0,128,24,0,0,128,24,0,0,128,24,0,0,192,16,1,240,64,48,3,28,96,32,4,6,56,192,8,2,15,128,8,3,0,0,24,1,0,0,24,1,0,0,24,1,0,0,8,3,0,0,12,6,0,0,6,12,0,0,3,248,0,0,0,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,192,0,0,28,112,0,0,48,24,1,192,32,8,7,240,96,12,12,24,64,12,24,12,64,4,16,4,96,12,48,6,32,8,32,2,48,24,48,2,24,48,48,6,15,224,16,4,3,128,24,12,0,0,14,56,0,0,3,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,192,0,0,6,112,3,128,8,24,15,224,16,12,24,24,48,4,48,8,32,4,32,12,32,6,96,4,32,6,96,4,48,4,96,4,16,12,32,12,24,24,48,8,7,240,16,16,3,192,14,96,0,0,3,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,192,0,0,7,240,0,0,12,8,0,0,24,4,0,0,16,6,0,0,48,2,15,192,48,2,28,96,48,2,48,16,16,6,32,24,24,4,96,8,8,12,64,12,14,56,64,12,3,240,64,12,0,0,96,8,0,0,32,24,0,0,16,48,0,0,15,224,0,0,3,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,224,0,0,7,56,0,0,12,12,0,0,8,6,0,0,16,2,0,0,16,2,0,0,16,3,0,0,16,2,7,0,24,2,31,224,8,6,48,48,12,12,96,16,7,248,64,24,1,224,64,8,0,0,192,8,0,0,64,8,0,0,64,24,0,0,96,16,0,0,48,48,0,0,28,224,0,0,7,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,224,0,0,3,248,0,0,6,12,0,0,12,2,0,0,8,3,0,0,24,1,0,0,24,1,0,0,24,1,0,0,8,3,0,0,12,2,15,128,6,6,56,192,3,28,96,96,1,240,64,48,0,0,192,16,0,0,128,24,0,0,128,24,0,0,128,24,0,0,192,16,0,0,64,48,0,0,96,96,0,0,63,192,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,248,0,0,3,12,0,0,6,6,0,0,12,3,0,0,8,1,0,0,8,1,0,0,8,1,0,0,8,1,0,0,8,1,0,0,4,2,0,0,6,6,31,192,3,252,96,96,0,0,64,32,0,0,128,16,0,0,128,16,0,0,128,16,0,0,128,16,0,0,128,16,0,0,192,48,0,0,96,96,0,0,48,192,0,0,31,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,248,0,0,3,12,0,0,6,2,0,0,12,3,0,0,8,1,0,0,8,1,0,0,8,1,0,0,8,1,0,0,12,3,0,0,4,2,0,0,3,14,31,128,1,248,96,192,0,0,64,32,0,0,192,48,0,0,128,16,0,0,128,16,0,0,128,16,0,0,128,16,0,0,128,48,0,0,64,96,0,0,48,192,0,0,31,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,240,0,0,3,28,0,0,6,6,0,0,12,3,0,0,8,3,0,0,24,1,0,0,24,1,0,0,8,1,0,0,8,3,0,0,12,2,15,0,6,6,63,192,3,252,96,96,0,240,64,48,0,0,192,16,0,0,128,16,0,0,128,16,0,0,128,16,0,0,192,16,0,0,64,48,0,0,96,96,0,0,56,192,0,0,15,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,240,0,0,12,28,0,0,8,4,0,0,16,6,0,0,16,2,0,0,16,2,0,0,16,2,15,192,16,2,24,96,24,6,32,48,8,4,96,24,6,24,64,8,3,240,64,8,0,0,64,8,0,0,64,8,0,0,96,8,0,0,32,16,0,0,56,48,0,0,15,192,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,240,7,224,12,24,24,48,16,12,16,24,16,4,32,8,32,6,96,12,32,6,96,4,32,6,96,4,32,4,32,4,16,4,32,12,24,8,48,8,12,56,24,48,7,224,15,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,192,0,0,24,48,0,0,48,24,0,0,32,8,7,240,96,12,12,24,64,12,24,12,64,12,16,4,96,12,16,6,32,8,48,2,48,24,48,2,24,48,48,6,15,224,16,4,0,0,24,12,0,0,12,24,0,0,7,240,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,192,0,0,28,224,0,0,48,48,0,0,32,24,0,0,96,8,1,192,64,8,7,240,64,12,12,12,64,12,24,4,96,8,16,6,32,24,16,2,48,48,16,2,31,224,16,2,7,128,16,6,0,0,24,4,0,0,8,12,0,0,7,56,0,0,3,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,224,0,0,24,48,0,0,48,24,0,0,96,8,3,240,96,12,14,56,64,12,8,12,64,12,16,4,96,8,16,6,32,8,48,2,48,16,48,2,28,112,48,2,15,192,16,6,0,0,24,4,0,0,12,24,0,0,7,240,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,224,0,0,24,48,7,240,48,24,12,24,32,8,24,12,32,12,16,4,96,4,32,4,96,4,32,6,32,4,32,6,32,8,48,6,48,24,16,4,24,48,24,12,15,224,12,56,0,0,7,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,192,0,0,14,48,3,128,24,8,15,224,16,4,24,16,48,4,48,8,32,4,32,12,32,6,96,4,32,6,96,4,48,4,96,4,16,12,32,12,8,24,32,8,7,240,16,24,1,192,12,112,0,0,7,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,192,0,0,7,240,0,0,12,24,0,0,24,12,7,192,16,4,28,112,48,6,48,24,32,6,32,8,32,6,32,12,48,4,96,4,16,4,96,4,24,8,96,12,14,56,32,8,3,224,48,24,0,0,24,48,0,0,15,224,0,0,3,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,224,0,0,12,56,0,0,24,12,15,224,16,4,24,48,48,6,48,24,32,6,32,8,32,6,96,4,48,4,96,4,48,4,96,4,24,12,96,12,12,24,32,8,7,224,48,24,0,0,28,48,0,0,15,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,192,0,0,7,240,7,192,8,24,28,112,16,12,16,24,48,4,32,8,32,4,96,12,32,6,96,4,32,6,96,4,48,4,96,4,16,4,32,12,24,8,48,8,14,56,24,16,3,224,15,224,0,0,3,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,224,7,224,12,56,28,48,24,12,48,24,48,4,32,12,48,6,96,12,32,6,96,4,32,6,96,4,32,4,32,4,16,4,32,8,24,8,16,24,12,24,24,48,7,224,7,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,224,7,224,12,56,28,48,24,12,48,24,48,4,32,12,48,6,96,12,32,6,96,4,32,6,96,4,32,4,32,4,16,4,32,8,24,8,16,24,12,24,24,48,7,224,7,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0}
};

const uint8_t CLOCK_FRAME_COUNT = sizeof(frames_clock) / sizeof(frames_clock[0]);

// --- Pool Stats Page Animation ---
#define POOL_W 32
#define POOL_H 32
#define POOL_BYTES ((POOL_W * POOL_H) / 8)
#define POOL_FRAME_DELAY 42

const uint8_t PROGMEM frames_pool[][POOL_BYTES] = {
  {60,0,62,0,102,0,103,0,194,0,65,0,131,0,65,0,131,0,65,0,194,0,67,0,126,0,62,0,25,0,56,0,0,128,32,0,0,64,32,0,0,39,224,0,0,28,48,0,0,16,24,0,0,48,12,0,0,32,4,0,0,32,4,62,0,32,4,98,0,32,7,195,0,48,12,193,0,48,8,193,0,124,48,67,0,199,240,126,127,128,16,0,71,0,24,0,131,0,15,0,131,0,31,128,131,0,16,192,194,0,16,64,126,0,16,64,0,0,16,64,0,0,24,192,0,0,15,128},
  {60,0,62,0,102,0,103,0,194,0,65,0,131,0,65,0,131,0,65,0,194,0,67,0,126,0,62,0,25,0,56,0,0,128,32,0,0,64,32,0,0,39,224,0,0,28,48,0,0,16,24,0,0,48,12,0,0,32,4,0,0,32,4,62,0,32,4,98,0,32,7,195,0,48,12,193,0,48,8,193,0,124,48,67,0,199,240,126,127,128,16,0,71,0,24,0,131,0,15,0,131,0,31,128,131,0,16,192,194,0,16,64,126,0,16,64,0,0,16,64,0,0,24,192,0,0,15,128},
  {60,0,62,0,102,0,103,0,194,0,65,0,131,0,65,0,131,0,65,0,194,0,67,0,126,0,62,0,25,0,56,0,0,128,32,0,0,64,32,0,0,39,224,0,0,28,48,0,0,16,24,0,0,48,12,0,0,32,4,0,0,32,4,62,0,32,4,98,0,32,7,195,0,48,12,193,0,48,8,193,0,124,48,67,0,199,240,126,127,128,16,0,71,0,24,0,131,0,15,0,131,0,31,128,131,0,16,192,194,0,16,64,126,0,16,64,0,0,16,64,0,0,24,192,0,0,15,128},
  {60,0,62,0,102,0,103,0,194,0,65,0,131,0,65,0,131,0,65,0,194,0,67,0,126,0,62,0,25,0,56,0,0,128,32,0,0,64,32,0,0,39,224,0,0,28,48,0,0,16,24,0,0,48,12,0,0,32,4,0,0,32,4,62,0,32,4,98,0,32,7,195,0,48,12,193,0,48,8,193,0,124,48,67,0,199,240,126,127,128,16,0,71,0,24,0,131,0,15,0,131,0,31,128,131,0,16,192,194,0,16,64,126,0,16,64,0,0,16,64,0,0,24,192,0,0,15,128},
  {60,0,30,0,102,0,127,0,195,0,97,0,131,0,65,0,195,0,65,0,194,0,65,0,126,0,127,0,25,0,60,0,0,128,48,0,0,64,32,0,0,39,224,0,0,28,48,0,0,16,24,0,0,48,12,0,0,32,4,0,0,32,4,62,0,32,4,98,0,32,7,195,0,48,12,193,0,48,8,195,0,124,48,67,0,199,240,126,127,128,16,0,71,0,24,0,131,0,15,0,131,0,31,128,131,0,16,192,194,0,16,64,126,0,48,64,0,0,16,64,0,0,24,192,0,0,15,128},
  {60,0,28,0,102,0,63,0,67,0,97,0,193,0,65,128,193,0,65,128,67,0,97,128,127,0,35,0,25,128,62,0,0,192,48,0,0,96,32,0,0,55,224,0,0,28,48,0,0,16,24,0,0,48,12,0,0,32,4,0,0,32,4,60,0,32,4,102,0,32,7,195,0,48,12,193,0,48,8,195,0,124,48,195,56,199,240,126,127,0,48,24,194,0,16,0,131,0,30,0,131,0,31,128,194,0,48,192,102,0,32,192,56,0,32,192,0,0,48,192,0,0,25,128,0,0,15,0},
  {30,0,0,0,51,0,31,0,65,0,49,128,65,0,32,128,65,0,32,128,97,0,32,128,63,0,49,128,13,128,31,0,0,192,16,0,0,96,48,0,0,55,224,0,0,28,48,0,0,16,24,0,0,48,12,0,0,32,4,0,0,32,4,56,0,32,4,126,0,32,7,194,0,48,13,131,0,48,8,131,0,236,48,194,125,135,224,126,71,0,48,60,131,0,16,0,131,0,30,0,131,0,63,0,194,0,32,128,126,0,32,128,0,0,32,128,0,0,32,128,0,0,63,128,0,0,14,0},
  {30,0,0,0,51,0,14,0,32,128,31,128,32,128,48,128,32,128,32,192,33,128,32,192,63,128,48,128,12,128,31,128,0,64,30,0,0,96,16,0,0,55,240,0,0,28,48,0,0,16,24,0,0,48,12,0,0,32,4,0,0,32,4,0,0,32,4,124,0,32,6,198,0,48,15,130,0,112,8,130,124,204,48,130,103,7,224,198,195,0,32,124,131,0,48,0,131,0,62,0,194,0,63,0,126,0,97,0,0,0,65,128,0,0,65,128,0,0,97,0,0,0,63,0,0,0,28,0},
  {15,0,0,0,25,128,0,0,48,192,15,128,48,64,24,192,48,192,16,64,48,192,16,64,31,128,16,64,6,192,24,192,0,96,15,128,0,48,24,0,0,23,240,0,0,28,48,0,0,16,24,0,0,48,12,0,0,32,4,0,0,32,4,0,0,32,4,120,0,32,4,206,0,48,15,130,60,240,9,130,103,140,48,130,195,7,224,134,131,0,96,252,131,0,32,16,194,0,60,0,126,0,102,0,0,0,195,0,0,0,131,0,0,0,195,0,0,0,194,0,0,0,126,0,0,0,24,0},
  {7,128,0,0,12,192,0,0,24,64,3,128,16,96,15,192,16,96,8,96,24,64,24,32,15,192,24,32,3,64,24,96,0,32,12,64,0,48,15,128,0,31,248,0,0,28,48,0,0,16,24,0,0,48,12,0,0,32,4,0,0,32,4,0,0,32,4,0,0,32,4,252,124,112,15,134,71,208,9,130,131,12,49,130,131,7,225,134,131,0,64,196,194,0,96,120,126,0,120,0,0,0,204,0,0,1,134,0,0,1,2,0,0,1,134,0,0,1,134,0,0,0,252,0,0,0,0,0},
  {3,192,0,0,6,96,0,0,12,32,0,0,8,48,3,192,8,48,6,96,12,32,12,32,7,224,8,48,1,224,8,48,0,48,12,32,0,16,15,224,0,15,233,128,0,12,56,0,0,16,24,0,0,48,12,0,0,32,4,0,0,32,4,0,0,32,4,0,126,32,4,120,195,240,15,204,131,16,11,132,131,12,49,6,131,7,225,6,194,0,193,132,126,0,64,252,0,1,240,48,0,1,24,0,0,3,12,0,0,2,12,0,0,3,12,0,0,1,8,0,0,1,248,0,0,0,0,0},
  {1,224,0,0,3,48,0,0,6,16,0,0,4,24,0,0,4,24,3,224,6,16,6,48,3,240,4,16,0,240,4,16,0,16,4,16,0,24,6,48,0,15,231,224,0,12,56,0,0,16,24,0,0,48,12,0,0,32,4,0,56,32,4,0,126,32,4,0,195,224,4,0,131,176,12,248,131,16,15,140,194,12,49,4,126,7,225,4,56,1,129,4,0,0,193,140,0,3,240,248,0,6,16,0,0,4,24,0,0,4,24,0,0,4,24,0,0,6,16,0,0,3,240,0,0,0,0,0},
  {0,240,0,0,1,152,0,0,3,12,0,0,2,12,0,0,2,12,0,0,3,8,3,240,1,248,2,24,0,112,6,8,0,24,6,8,0,8,6,24,0,15,227,16,0,12,63,224,0,16,24,0,0,48,12,0,124,32,4,0,70,32,4,0,131,224,4,0,131,224,4,0,131,48,12,112,194,16,15,248,126,12,51,12,0,7,227,4,0,1,131,4,0,1,131,12,0,7,193,152,0,12,96,240,0,8,32,0,0,8,32,0,0,8,32,0,0,12,96,0,0,7,192,0,0,0,0,0},
  {0,120,0,0,0,204,0,0,1,134,0,0,1,130,0,0,1,134,0,0,1,134,0,224,0,252,1,248,0,56,3,8,0,12,2,8,0,4,2,12,0,7,226,8,0,12,55,24,56,16,29,240,126,48,12,0,194,32,4,0,131,224,4,0,131,224,4,0,194,32,4,0,70,48,12,0,60,16,13,240,0,12,55,152,0,7,226,8,0,3,2,8,0,7,2,8,0,31,131,8,0,16,193,248,0,16,64,0,0,16,64,0,0,16,64,0,0,31,192,0,0,7,0,0,0,0,0,0},
  {0,60,0,0,0,102,0,0,0,67,0,0,0,193,0,0,0,193,0,0,0,67,0,0,0,126,0,240,0,28,1,152,0,4,1,12,0,6,3,4,0,7,227,4,60,12,51,12,102,16,31,248,194,48,12,112,131,224,4,0,131,224,4,0,194,32,4,0,126,32,4,0,0,48,12,0,0,16,12,0,0,12,63,240,0,7,226,24,0,2,2,8,0,30,6,8,0,51,2,8,0,97,131,24,0,96,129,240,0,96,128,0,0,97,128,0,0,63,0,0,0,14,0,0,0,0,0,0},
  {0,30,0,0,0,51,0,0,0,32,128,0,0,96,128,0,0,32,128,0,0,33,128,0,0,63,0,0,0,14,0,120,0,2,1,204,0,3,1,4,126,7,225,4,194,12,49,4,131,16,27,132,131,48,14,252,195,224,4,32,70,32,4,0,60,32,4,0,0,32,4,0,0,48,12,0,0,16,8,0,0,12,61,192,0,7,231,240,0,4,6,16,0,124,4,24,0,102,4,24,0,195,6,24,0,131,3,240,0,131,1,192,0,194,0,0,0,126,0,0,0,0,0,0,0,0,0,0},
  {0,15,0,0,0,25,192,0,0,16,64,0,0,16,64,0,0,16,64,0,0,16,192,0,0,31,128,0,0,3,0,0,60,3,0,120,102,3,0,204,194,7,225,134,131,12,49,6,131,16,25,134,195,240,15,132,126,96,4,252,24,32,4,48,0,32,4,0,0,32,4,0,0,48,12,0,0,16,8,0,0,12,56,0,0,15,231,224,0,8,6,48,0,248,4,16,1,140,4,16,1,4,4,16,1,4,4,16,1,4,3,224,1,140,0,0,0,248,0,0,0,0,0,0,0,0,0,0},
  {0,7,192,0,0,12,224,0,0,8,32,0,0,8,32,0,0,8,32,0,0,8,96,0,0,7,192,0,126,1,128,0,194,1,0,0,131,1,128,120,131,7,224,204,131,12,48,134,195,208,25,130,126,112,13,130,0,32,7,134,0,32,4,252,0,32,4,56,0,32,4,0,0,48,12,0,0,16,8,0,0,12,56,0,0,15,236,0,0,24,7,224,1,240,4,48,3,24,12,16,2,8,12,16,2,8,12,48,2,8,6,32,3,24,3,192,1,240,0,0,0,0,0,0,0,0,0,0},
  {0,3,224,0,0,6,112,0,0,4,16,0,0,4,16,0,0,4,16,0,56,4,48,0,126,3,224,0,194,1,128,0,131,0,128,0,131,1,128,0,195,7,224,124,127,140,48,206,56,112,24,130,0,48,12,130,0,32,7,130,0,32,7,130,0,32,4,254,0,32,4,56,0,48,12,0,0,16,8,0,0,28,56,0,0,31,248,0,1,240,15,192,7,224,6,96,4,48,12,32,4,16,8,48,12,16,8,48,4,16,12,32,6,48,7,224,3,224,1,128,0,0,0,0,0,0,0,0},
  {0,1,240,0,0,3,56,0,0,2,8,0,0,2,8,0,60,2,8,0,102,2,24,0,194,3,240,0,131,0,192,0,131,0,192,0,195,0,192,0,127,135,224,0,24,204,48,60,0,48,24,230,0,48,12,130,0,32,4,130,0,32,7,130,0,32,4,130,0,32,4,254,0,48,12,56,0,16,8,0,0,28,48,0,0,55,248,0,3,224,8,0,15,192,15,192,8,96,12,96,24,32,8,32,24,32,8,32,8,96,8,32,12,192,12,96,3,128,7,192,0,0,0,0,0,0,0,0},
  {0,0,240,0,0,1,152,0,0,1,4,0,124,3,4,0,102,1,4,0,194,1,12,0,131,1,248,0,131,0,96,0,195,0,64,0,127,128,192,0,0,199,224,0,0,124,48,0,0,48,24,60,0,48,12,102,0,32,4,194,0,32,7,131,0,32,7,131,0,32,4,194,0,48,12,126,0,16,8,24,0,28,48,0,0,55,240,0,15,224,8,0,31,192,15,128,16,192,12,192,16,64,8,96,16,64,24,32,16,192,24,32,31,128,8,96,7,0,15,192,0,0,3,128,0,0,0,0},
  {0,0,120,0,0,0,204,0,60,1,134,0,102,1,130,0,194,1,134,0,131,1,134,0,131,0,252,0,194,0,112,0,127,0,96,0,1,128,64,0,0,199,224,0,0,60,48,0,0,16,24,0,0,48,12,124,0,32,4,70,0,32,6,195,0,32,7,131,0,32,4,131,0,48,12,194,0,16,8,126,0,60,48,0,0,103,240,0,31,192,24,0,51,128,8,0,32,128,15,192,32,128,24,64,32,128,16,96,33,128,16,96,63,0,24,96,4,0,8,192,0,0,7,128,0,0,0,0},
  {0,0,60,0,60,0,230,0,126,0,130,0,194,0,130,0,131,0,130,0,131,0,194,0,194,0,126,0,127,0,48,0,57,128,32,0,0,192,96,0,0,103,224,0,0,60,48,0,0,16,24,0,0,48,12,0,0,32,4,126,0,32,4,66,0,32,7,195,0,32,7,129,0,48,12,195,0,16,8,66,0,60,48,126,0,103,240,0,31,192,16,0,51,0,8,0,97,0,15,128,65,128,24,192,65,128,16,64,97,0,16,64,63,0,16,64,0,0,24,64,0,0,15,192,0,0,0,0},
  {0,0,60,0,126,0,102,0,194,0,195,0,131,0,193,0,131,0,193,0,194,0,67,0,70,0,126,0,63,0,56,0,1,128,32,0,0,192,96,0,0,103,224,0,0,60,48,0,0,16,24,0,0,48,12,0,0,32,4,28,0,32,4,126,0,32,6,195,0,32,7,193,0,48,12,193,0,16,8,195,0,60,48,126,0,199,240,28,63,128,16,0,99,0,24,0,65,0,15,128,193,0,31,192,65,0,16,64,67,0,16,64,126,0,16,64,0,0,16,64,0,0,31,192,0,0,7,0},
  {56,0,60,0,126,0,103,0,194,0,65,0,131,0,65,0,131,0,65,0,194,0,67,0,126,0,126,0,59,0,56,0,1,128,32,0,0,192,32,0,0,103,224,0,0,60,48,0,0,16,24,0,0,48,12,0,0,32,4,0,0,32,4,126,0,32,6,67,0,32,7,193,0,48,12,193,0,48,8,195,0,124,48,67,0,199,240,126,127,128,16,0,71,0,24,0,195,0,15,0,131,0,31,128,195,0,16,192,66,0,16,64,126,0,16,64,0,0,16,64,0,0,25,192,0,0,7,0},
  {60,0,62,0,102,0,103,0,194,0,65,0,131,0,65,0,131,0,65,0,194,0,67,0,126,0,62,0,25,0,56,0,0,128,32,0,0,64,32,0,0,39,224,0,0,28,48,0,0,16,24,0,0,48,12,0,0,32,4,0,0,32,4,62,0,32,4,98,0,32,7,195,0,48,12,193,0,48,8,193,0,124,48,67,0,199,240,126,127,128,16,0,71,0,24,0,131,0,15,0,131,0,31,128,131,0,16,192,194,0,16,64,126,0,16,64,0,0,16,64,0,0,24,192,0,0,15,128},
  {60,0,62,0,102,0,103,0,194,0,65,0,131,0,65,0,131,0,65,0,194,0,67,0,126,0,62,0,25,0,56,0,0,128,32,0,0,64,32,0,0,39,224,0,0,28,48,0,0,16,24,0,0,48,12,0,0,32,4,0,0,32,4,62,0,32,4,98,0,32,7,195,0,48,12,193,0,48,8,193,0,124,48,67,0,199,240,126,127,128,16,0,71,0,24,0,131,0,15,0,131,0,31,128,131,0,16,192,194,0,16,64,126,0,16,64,0,0,16,64,0,0,24,192,0,0,15,128},
  {60,0,62,0,102,0,103,0,194,0,65,0,131,0,65,0,131,0,65,0,194,0,67,0,126,0,62,0,25,0,56,0,0,128,32,0,0,64,32,0,0,39,224,0,0,28,48,0,0,16,24,0,0,48,12,0,0,32,4,0,0,32,4,62,0,32,4,98,0,32,7,195,0,48,12,193,0,48,8,193,0,124,48,67,0,199,240,126,127,128,16,0,71,0,24,0,131,0,15,0,131,0,31,128,131,0,16,192,194,0,16,64,126,0,16,64,0,0,16,64,0,0,24,192,0,0,15,128}
};

const uint8_t POOL_FRAME_COUNT = sizeof(frames_pool) / sizeof(frames_pool[0]);

// --- User Stats Page Animation ---
#define USER_W 32
#define USER_H 32
#define USER_BYTES ((USER_W * USER_H) / 8)
#define USER_FRAME_DELAY 42

const uint8_t PROGMEM frames_user[][USER_BYTES] = {
  {0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,7,0,0,0,14,0,0,0,24,0,1,128,48,0,3,192,96,0,6,112,192,0,12,31,128,0,24,15,0,0,96,7,0,1,224,0,0,7,0,0,0,28,0,0,0,240,0,0,0,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,1,128,7,0,3,128,12,0,6,192,24,0,12,96,48,224,24,48,96,255,240,24,192,1,224,15,128,0,0,7,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,7,0,0,0,14,0,0,0,24,0,1,128,48,0,3,192,96,0,6,112,192,0,12,31,128,0,24,15,0,0,96,7,0,1,224,0,0,7,0,0,0,28,0,0,0,240,0,0,0,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,1,128,7,0,3,128,12,0,6,192,24,0,12,96,48,224,24,48,96,255,240,24,192,1,224,15,128,0,0,7,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,7,0,0,0,14,0,0,0,24,0,1,128,48,0,3,192,96,0,6,112,192,0,12,31,128,0,24,15,0,0,96,7,0,1,224,0,0,7,0,0,0,28,0,0,0,240,0,0,0,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,1,128,7,0,3,128,12,0,6,192,24,0,12,96,48,224,24,48,96,255,240,24,192,1,224,15,128,0,0,7,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,7,0,0,0,14,0,0,0,24,0,1,128,48,0,3,192,96,0,6,112,192,0,12,31,128,0,24,15,0,0,96,7,0,1,224,0,0,7,0,0,0,28,0,0,0,240,0,0,0,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,1,128,7,0,3,128,12,0,6,192,24,0,12,96,48,224,24,48,96,255,240,24,192,1,224,15,128,0,0,7,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,7,0,0,0,14,0,0,0,24,0,1,128,48,0,3,192,96,0,6,112,192,0,12,31,128,0,24,15,0,0,96,7,0,1,224,0,0,7,0,0,0,92,0,0,0,240,0,0,0,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,1,128,7,0,3,128,12,0,6,192,24,0,12,96,48,224,24,48,96,255,240,24,192,1,224,15,128,0,0,7,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,7,0,0,0,14,0,0,0,24,0,1,128,48,0,3,192,96,0,6,112,192,0,12,31,128,0,24,15,0,0,96,7,0,1,224,0,0,7,64,0,0,28,0,0,0,112,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,1,128,7,0,3,128,12,0,6,192,24,0,12,96,48,96,24,48,96,127,240,24,192,1,224,15,128,0,64,7,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,7,0,0,0,14,0,0,0,24,0,1,128,48,0,3,192,96,0,6,112,192,0,12,31,128,0,24,15,0,0,96,7,0,1,192,0,0,7,0,0,0,28,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,1,128,7,0,3,128,12,0,6,192,24,0,12,96,48,0,24,48,96,31,240,24,192,1,192,15,128,0,0,7,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,7,0,0,0,14,0,0,0,24,0,1,128,48,0,3,192,96,0,6,112,192,0,12,31,128,0,24,15,0,0,96,7,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,7,0,1,128,12,0,6,64,24,0,12,32,48,0,24,48,96,0,48,24,192,0,0,15,0,0,0,7,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,7,0,0,0,14,0,0,0,24,0,0,0,48,0,0,192,96,0,0,112,192,0,0,25,128,0,0,15,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,7,0,0,0,12,0,0,64,24,0,0,96,48,0,0,48,96,0,0,24,192,0,0,15,0,0,0,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,7,0,0,0,14,0,0,0,24,0,0,0,48,0,0,0,96,0,0,0,192,0,0,1,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,7,0,0,0,12,0,0,0,24,0,0,0,48,0,0,0,96,0,0,0,192,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,12,0,0,0,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,6,0,0,0,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,112,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,224,0,0,0,240,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,7,0,0,0,92,0,0,0,240,0,0,0,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,224,0,0,0,255,0,0,0,1,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,12,0,0,0,24,0,0,0,96,0,0,1,224,0,0,7,0,0,0,28,0,0,0,240,0,0,0,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0,0,0,12,0,0,224,24,0,0,255,240,0,0,1,224,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,128,0,0,3,192,0,0,6,112,0,0,12,16,0,0,24,0,0,0,112,0,0,1,224,0,0,7,0,0,0,28,0,0,0,240,0,0,0,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,128,0,0,3,192,0,0,6,192,0,0,12,32,0,224,24,48,0,255,240,24,0,1,224,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,128,0,0,3,192,0,0,6,112,192,0,12,25,128,0,24,15,0,0,96,2,0,1,224,0,0,7,0,0,0,28,0,0,0,240,0,0,0,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,128,0,0,3,128,0,0,6,192,0,0,12,32,0,224,24,48,64,255,240,24,128,1,224,15,0,0,0,7,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,24,0,1,128,48,0,3,192,96,0,6,112,192,0,12,31,128,0,24,15,0,0,96,7,0,1,224,0,0,7,0,0,0,28,0,0,0,240,0,0,0,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,128,0,0,3,128,12,0,6,192,24,0,12,32,48,224,24,48,96,255,240,24,192,1,224,15,128,0,0,7,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,7,0,0,0,12,0,0,0,24,0,1,128,48,0,3,192,96,0,6,112,192,0,12,31,128,0,24,15,0,0,96,7,0,1,224,0,0,7,0,0,0,28,0,0,0,240,0,0,0,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,1,128,7,0,3,128,12,0,6,192,24,0,12,96,48,224,24,48,96,255,240,24,192,1,224,15,128,0,0,7,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,7,0,0,0,14,0,0,0,24,0,1,128,48,0,3,192,96,0,6,112,192,0,12,31,128,0,24,15,0,0,96,7,0,1,224,0,0,7,0,0,0,28,0,0,0,240,0,0,0,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,1,128,7,0,3,128,12,0,6,192,24,0,12,96,48,224,24,48,96,255,240,24,192,1,224,15,128,0,0,7,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,7,0,0,0,14,0,0,0,24,0,1,128,48,0,3,192,96,0,6,112,192,0,12,31,128,0,24,15,0,0,96,7,0,1,224,0,0,7,0,0,0,28,0,0,0,240,0,0,0,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,1,128,7,0,3,128,12,0,6,192,24,0,12,96,48,224,24,48,96,255,240,24,192,1,224,15,128,0,0,7,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,7,0,0,0,14,0,0,0,24,0,1,128,48,0,3,192,96,0,6,112,192,0,12,31,128,0,24,15,0,0,96,7,0,1,224,0,0,7,0,0,0,28,0,0,0,240,0,0,0,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,1,128,7,0,3,128,12,0,6,192,24,0,12,96,48,224,24,48,96,255,240,24,192,1,224,15,128,0,0,7,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0}
};

const uint8_t USER_FRAME_COUNT = sizeof(frames_user) / sizeof(frames_user[0]);

// --- STARTUP ANIM (48x48) ---
#define STARTUP_W 48
#define STARTUP_H 48
#define STARTUP_FRAME_BYTES ((STARTUP_W * STARTUP_H) / 8) // = 288
#define STARTUP_FRAME_DELAY 42

const uint8_t PROGMEM frames_startup[][STARTUP_FRAME_BYTES] = {
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,62,0,0,0,0,0,115,0,0,0,0,1,243,192,0,0,0,15,192,252,0,0,0,31,0,62,0,0,0,56,0,6,0,0,0,48,62,7,0,0,0,24,127,142,0,0,0,24,193,140,0,0,0,24,192,140,0,0,0,24,192,204,0,0,0,24,192,140,0,0,0,24,97,140,0,0,0,24,127,14,0,0,0,48,30,7,0,0,0,58,0,22,0,0,14,31,0,62,0,0,31,15,192,252,0,0,59,0,243,192,0,0,241,224,51,0,0,5,224,244,62,0,0,15,128,62,30,124,0,31,0,31,0,124,0,24,31,3,0,238,0,28,63,135,3,199,128,12,97,198,63,1,248,12,96,198,62,0,248,12,96,198,100,0,76,12,96,198,96,124,12,12,96,198,112,254,28,28,63,134,49,131,24,24,31,3,49,131,24,24,0,3,49,131,24,31,0,62,49,131,24,15,192,126,49,131,24,0,241,224,112,254,28,0,59,128,96,124,12,0,31,0,96,0,12,0,31,0,62,0,248,0,0,0,63,1,248,0,0,0,3,199,128,0,0,0,0,238,0,0,0,0,0,124,0,0,0,0,0,124,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,60,0,0,0,0,0,124,0,0,0,0,0,103,0,0,0,0,0,231,216,0,0,0,3,192,252,0,0,0,31,0,126,0,0,0,62,0,6,0,0,0,48,62,12,0,0,0,48,127,12,0,0,0,56,65,140,0,0,0,24,193,140,0,0,0,24,192,204,0,0,0,24,193,142,0,0,0,24,97,135,0,0,0,12,127,3,0,0,0,28,62,7,0,0,0,24,0,30,0,0,7,31,0,62,0,0,15,143,192,224,0,0,29,140,249,192,0,4,121,192,57,128,0,15,224,240,31,0,0,15,128,62,15,30,0,24,0,31,0,62,0,12,31,15,0,118,0,12,63,131,155,231,128,12,112,199,63,129,192,12,96,198,62,0,248,12,96,198,112,0,124,12,96,198,48,124,12,28,96,198,48,254,14,56,63,134,49,195,28,24,31,6,49,131,24,30,0,7,49,131,24,31,0,22,49,131,24,1,192,126,113,131,24,0,227,252,224,254,24,0,119,128,96,124,24,0,62,0,124,0,28,0,62,0,62,0,216,0,0,0,7,3,248,0,0,0,3,207,176,0,0,0,0,220,0,0,0,0,0,248,0,0,0,0,0,248,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,120,0,0,0,0,0,248,0,0,0,0,0,207,16,0,0,0,1,207,248,0,0,0,3,128,252,0,0,0,7,0,12,0,0,0,62,0,12,0,0,0,60,62,24,0,0,0,48,127,12,0,0,0,112,97,140,0,0,0,56,193,140,0,0,0,24,192,206,0,0,0,24,192,135,0,0,0,24,97,131,0,0,0,12,127,3,0,0,0,12,62,31,0,0,0,12,0,62,0,0,3,24,0,112,0,0,7,207,192,224,0,0,14,199,252,192,0,7,252,192,61,192,0,15,224,112,15,128,0,12,0,56,7,14,0,12,0,31,0,31,0,6,31,15,8,123,0,14,63,131,31,243,128,12,97,193,191,1,192,12,96,195,176,0,224,12,96,198,56,0,124,28,96,198,24,124,60,56,96,198,48,254,6,48,59,134,49,131,6,30,31,12,49,131,30,31,0,12,49,131,24,3,128,6,113,131,24,1,192,110,193,131,24,0,227,252,192,254,24,0,111,152,120,124,48,0,124,0,124,0,56,0,120,0,14,0,24,0,0,0,7,3,248,0,0,0,3,159,240,0,0,0,1,190,32,0,0,0,1,240,0,0,0,0,0,224,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,0,0,0,0,1,240,0,0,0,0,1,191,112,0,0,0,1,159,248,0,0,0,3,128,220,0,0,0,7,0,24,0,0,0,6,0,24,0,0,0,60,63,24,0,0,0,60,127,140,0,0,0,96,225,140,0,0,0,112,193,142,0,0,0,56,192,199,0,0,0,24,192,131,0,0,0,24,97,131,0,0,0,12,127,15,0,0,0,12,62,30,0,0,0,6,0,24,0,0,1,140,0,112,0,0,3,236,192,96,0,3,159,231,252,64,0,7,254,99,190,224,0,6,224,112,3,192,0,6,0,56,3,6,0,6,0,24,0,15,128,6,30,14,14,253,128,14,63,143,159,249,128,12,113,193,153,129,192,12,96,193,152,0,224,60,96,199,152,0,112,56,96,199,24,124,60,48,96,198,48,254,30,60,59,134,49,131,6,30,31,12,49,131,6,6,0,12,241,131,30,3,0,12,193,131,24,1,192,76,193,131,24,0,207,252,240,254,24,0,223,248,120,124,48,0,248,16,12,0,48,0,48,0,14,0,48,0,0,0,7,1,48,0,0,0,3,63,240,0,0,0,3,126,224,0,0,0,3,224,0,0,0,0,0,192,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,1,224,96,0,0,0,3,255,240,0,0,0,3,63,184,0,0,0,3,0,24,0,0,0,7,0,48,0,0,0,6,0,24,0,0,0,12,62,28,0,0,0,60,127,12,0,0,0,120,225,142,0,0,0,96,193,135,0,0,0,112,192,195,0,0,0,120,192,131,0,0,0,24,97,143,0,0,0,12,127,14,0,0,0,12,62,24,0,0,0,6,0,24,0,0,0,6,0,48,0,0,128,230,0,96,0,1,255,247,254,32,0,7,255,51,255,240,0,3,32,49,129,224,0,3,0,56,0,0,0,7,0,24,3,7,128,6,30,12,15,255,192,14,63,143,29,252,192,12,113,199,140,0,192,60,96,193,140,0,224,56,96,193,156,0,112,48,96,199,152,124,48,60,96,199,48,254,60,60,59,134,49,199,30,6,31,12,241,131,6,7,0,28,193,131,6,3,0,24,193,131,30,1,128,24,241,131,24,1,159,216,120,254,24,1,255,248,24,124,48,1,240,112,28,0,112,0,96,0,14,0,96,0,0,0,6,0,96,0,0,0,6,127,112,0,0,0,7,255,224,0,0,0,3,193,128,0,0,0,0,128,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,193,224,0,0,0,3,255,240,0,0,0,6,127,48,0,0,0,6,0,48,0,0,0,7,0,48,0,0,0,6,0,24,0,0,0,12,62,28,0,0,0,12,127,12,0,0,0,56,225,143,0,0,0,120,193,131,0,0,0,96,192,195,0,0,0,112,192,135,0,0,0,120,97,143,0,0,0,28,127,12,0,0,0,12,30,24,0,0,0,6,0,56,0,0,0,7,0,48,0,0,224,99,0,48,0,1,255,243,63,184,0,3,191,219,255,240,0,1,128,25,192,224,0,3,128,24,0,0,0,7,0,24,3,129,128,6,30,12,7,255,224,14,63,140,6,255,96,60,113,198,6,0,96,56,96,199,142,0,96,48,96,193,156,0,112,56,96,193,152,124,48,60,96,199,176,254,16,12,51,135,241,195,28,6,31,12,193,131,30,7,0,28,193,131,6,3,0,56,225,131,6,3,0,48,113,131,30,3,63,48,16,254,24,3,255,248,24,124,48,1,192,240,28,0,112,0,0,64,12,0,224,0,0,0,12,0,192,0,0,0,12,252,224,0,0,0,15,255,224,0,0,0,3,3,128,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,3,224,0,0,0,7,255,224,0,0,0,15,254,96,0,0,0,12,64,96,0,0,0,6,0,48,0,0,0,6,0,24,0,0,0,12,62,30,0,0,0,12,127,15,0,0,0,8,97,131,0,0,0,56,192,131,0,0,0,120,192,199,0,0,0,96,192,142,0,0,0,112,97,140,0,0,0,60,127,12,0,0,0,28,62,24,0,0,0,6,0,24,0,0,0,7,0,24,0,0,240,3,129,152,0,1,254,113,159,248,0,1,159,253,255,240,0,1,128,205,240,0,0,3,128,12,96,192,0,7,0,24,3,192,0,6,30,12,7,253,224,62,63,140,2,63,240,60,113,198,7,1,48,48,96,198,14,0,48,56,64,199,156,0,112,60,96,193,184,124,48,12,96,193,240,254,24,12,59,135,193,195,24,6,31,15,193,131,28,6,0,28,225,129,14,7,0,56,113,131,6,6,0,112,49,199,6,7,254,96,56,254,30,3,255,112,24,124,60,1,131,224,28,0,112,0,1,192,24,0,224,0,0,0,25,1,192,0,0,0,31,248,128,0,0,0,15,253,192,0,0,0,6,7,128,0,0,0,0,6,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,0,0,7,192,0,0,0,6,124,192,0,0,0,15,252,192,0,0,0,13,192,224,0,0,0,12,0,48,0,0,0,12,0,30,0,0,0,12,62,31,0,0,0,12,127,131,0,0,0,24,225,131,0,0,0,24,192,135,0,0,0,24,192,206,0,0,0,120,192,140,0,0,0,96,97,140,0,0,0,56,127,12,0,0,0,60,30,24,0,0,0,30,0,28,0,0,24,7,0,12,0,0,120,3,128,252,0,0,239,17,207,248,0,0,207,252,222,48,0,1,192,254,248,0,0,3,128,6,112,224,0,7,0,12,1,240,0,30,31,12,3,190,96,60,63,140,3,31,240,48,113,198,7,1,184,56,96,198,14,0,24,28,64,198,60,0,48,12,96,199,248,124,48,12,96,193,240,254,56,12,59,129,193,199,24,6,31,15,225,131,24,6,0,31,113,129,28,14,0,24,49,131,14,14,192,112,49,199,6,7,252,96,48,254,6,3,62,224,24,124,60,0,7,192,24,0,124,0,3,192,48,0,224,0,0,0,59,1,192,0,0,0,31,241,128,0,0,0,12,249,128,0,0,0,0,31,0,0,0,0,0,14,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,0,0,0,0,0,15,128,0,0,0,0,57,128,0,0,0,6,249,192,0,0,0,15,192,224,0,0,0,25,0,62,0,0,0,24,0,30,0,0,0,12,62,15,0,0,0,12,127,3,0,0,0,24,97,135,0,0,0,24,192,142,0,0,0,24,192,204,0,0,0,24,192,140,0,0,0,56,97,140,0,0,0,48,127,12,0,0,0,52,62,12,0,0,0,62,0,14,0,0,60,31,0,46,0,0,60,3,192,252,0,0,102,0,231,248,0,0,231,200,111,0,0,1,224,252,124,0,0,3,128,54,56,240,0,31,0,6,0,248,0,30,31,14,1,156,0,48,63,140,3,143,240,56,113,198,7,1,248,28,96,198,62,0,216,12,64,198,124,0,24,12,96,198,120,124,56,12,96,199,192,254,24,12,51,131,241,199,24,14,31,3,49,131,24,12,0,31,49,129,24,28,0,30,49,131,24,15,192,112,49,199,30,7,248,224,48,254,6,0,60,192,56,124,12,0,15,128,48,0,124,0,7,128,50,0,248,0,0,0,63,1,192,0,0,0,31,227,128,0,0,0,0,243,0,0,0,0,0,62,0,0,0,0,0,30,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,31,0,0,0,0,0,51,0,0,0,0,0,243,192,0,0,0,15,192,252,0,0,0,31,0,126,0,0,0,56,0,30,0,0,0,56,62,7,0,0,0,28,127,14,0,0,0,8,97,140,0,0,0,24,192,140,0,0,0,24,192,204,0,0,0,24,193,140,0,0,0,24,97,140,0,0,0,56,127,14,0,0,0,48,62,6,0,0,0,62,0,6,0,0,30,31,0,126,0,0,31,3,193,252,0,0,51,0,227,192,0,0,243,192,119,0,0,1,224,254,62,0,0,15,128,62,62,120,0,31,0,7,0,124,0,24,31,3,0,206,0,24,63,134,3,207,128,12,113,198,39,3,248,12,96,198,62,0,248,12,64,198,124,0,12,12,96,198,96,124,12,12,96,198,112,254,24,12,57,135,49,135,24,28,31,3,49,131,24,24,0,3,49,131,24,31,0,62,49,131,24,15,192,126,49,131,24,0,241,224,48,254,28,0,57,128,112,124,12,0,31,0,96,0,124,0,15,0,62,0,248,0,0,0,63,129,248,0,0,0,3,231,128,0,0,0,0,230,0,0,0,0,0,124,0,0,0,0,0,60,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,60,0,0,0,0,0,62,0,0,0,0,0,103,0,0,0,0,1,227,200,0,0,0,3,192,252,0,0,0,31,0,62,0,0,0,62,0,6,0,0,0,48,63,14,0,0,0,56,127,140,0,0,0,24,225,140,0,0,0,24,192,140,0,0,0,24,192,204,0,0,0,24,193,140,0,0,0,8,97,142,0,0,0,28,127,7,0,0,0,24,62,3,0,0,0,56,0,30,0,0,15,31,0,126,0,0,15,143,192,224,0,0,25,129,243,192,0,0,249,192,59,0,0,15,224,240,31,0,0,15,128,62,31,60,0,24,0,31,0,62,0,28,30,3,0,230,0,12,63,131,3,231,128,12,113,199,63,3,192,12,96,198,62,0,248,12,64,198,96,0,124,12,96,198,112,124,12,12,96,198,48,254,14,24,51,134,49,195,28,56,31,6,49,131,24,30,0,3,49,131,24,31,128,54,49,131,24,15,192,126,113,195,24,0,243,236,96,254,24,0,51,128,96,124,28,0,62,0,124,0,12,0,62,0,62,0,248,0,0,0,7,129,248,0,0,0,3,207,144,0,0,0,0,206,0,0,0,0,0,248,0,0,0,0,0,120,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,120,0,0,0,0,0,252,0,0,0,0,0,207,0,0,0,0,0,199,248,0,0,0,3,192,252,0,0,0,7,0,14,0,0,0,62,0,12,0,0,0,60,62,12,0,0,0,48,127,12,0,0,0,112,225,140,0,0,0,56,192,140,0,0,0,24,192,204,0,0,0,24,193,142,0,0,0,8,97,135,0,0,0,12,127,3,0,0,0,12,62,31,0,0,0,28,0,62,0,0,7,24,0,112,0,0,7,207,192,224,0,0,12,199,249,192,0,7,252,192,61,128,0,15,224,240,15,128,0,12,128,56,7,30,0,12,0,31,0,31,0,14,30,15,0,243,0,6,63,131,159,243,128,12,97,195,191,1,192,12,96,199,48,0,224,12,96,198,48,0,124,28,96,198,24,124,60,56,96,198,24,254,6,48,51,142,49,131,14,30,31,12,49,131,28,31,0,14,49,131,24,15,0,6,113,131,24,1,192,126,225,131,24,0,227,252,192,254,48,0,103,136,120,124,48,0,124,0,124,0,24,0,60,0,14,0,24,0,0,0,7,1,248,0,0,0,3,159,240,0,0,0,1,158,0,0,0,0,1,240,0,0,0,0,0,240,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,112,0,0,0,0,1,248,0,0,0,0,1,223,48,0,0,0,1,143,248,0,0,0,3,128,220,0,0,0,7,0,12,0,0,0,6,0,24,0,0,0,60,62,24,0,0,0,56,127,12,0,0,0,96,225,140,0,0,0,112,192,140,0,0,0,56,192,199,0,0,0,24,193,135,0,0,0,8,97,131,0,0,0,12,127,15,0,0,0,12,30,31,0,0,0,14,0,24,0,0,1,12,0,112,0,0,3,237,192,224,0,3,31,231,252,192,0,7,254,99,62,192,0,14,224,112,7,192,0,14,0,56,3,6,0,6,0,24,0,15,128,6,30,15,14,125,128,14,63,143,159,249,128,12,113,193,187,1,192,12,96,193,152,0,224,28,96,199,152,0,112,56,96,198,24,124,60,48,96,198,56,254,30,56,59,134,49,131,6,62,31,12,49,131,14,14,0,12,113,131,28,3,128,12,225,131,24,1,192,78,193,131,24,0,199,252,240,254,24,0,207,248,120,124,48,0,248,0,28,0,48,0,120,0,14,0,48,0,0,0,7,1,184,0,0,0,3,63,240,0,0,0,3,126,224,0,0,0,3,224,0,0,0,0,0,192,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,0,0,0,0,1,224,96,0,0,0,3,255,240,0,0,0,3,31,248,0,0,0,3,128,24,0,0,0,7,0,56,0,0,0,6,0,24,0,0,0,12,62,24,0,0,0,60,127,12,0,0,0,120,97,140,0,0,0,96,192,143,0,0,0,112,192,199,0,0,0,56,193,131,0,0,0,8,97,135,0,0,0,12,127,15,0,0,0,12,62,24,0,0,0,6,0,56,0,0,0,6,0,112,0,0,1,230,0,96,0,3,223,247,254,96,0,7,255,51,255,224,0,6,32,49,3,224,0,3,0,56,1,2,0,3,0,24,2,7,128,6,30,12,15,255,192,14,63,143,31,252,192,12,97,199,152,0,192,28,96,193,140,0,224,56,96,193,156,0,112,48,96,199,152,124,48,48,96,198,56,254,30,60,63,134,49,135,30,14,31,12,241,131,6,7,0,28,225,131,14,3,0,24,193,131,30,1,128,28,225,131,24,1,159,220,248,254,24,1,191,248,24,124,48,1,240,32,28,0,112,0,96,0,14,0,96,0,0,0,6,0,48,0,0,0,6,127,240,0,0,0,7,255,224,0,0,0,3,192,192,0,0,0,0,128,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,192,224,0,0,0,3,255,240,0,0,0,7,127,48,0,0,0,3,0,48,0,0,0,7,0,48,0,0,0,6,0,24,0,0,0,12,62,24,0,0,0,12,127,140,0,0,0,120,193,143,0,0,0,112,192,135,0,0,0,96,192,195,0,0,0,112,192,135,0,0,0,56,97,143,0,0,0,12,127,12,0,0,0,12,30,24,0,0,0,6,0,56,0,0,0,3,0,48,0,0,192,99,0,48,0,1,255,247,127,48,0,3,191,187,255,240,0,3,0,25,192,224,0,3,0,56,0,0,0,7,0,24,3,131,128,6,31,12,15,255,224,14,63,140,12,254,96,60,97,199,140,0,96,56,96,199,142,0,96,48,96,193,156,0,112,48,96,193,152,124,48,60,96,199,184,254,56,12,63,134,241,131,30,6,31,12,225,131,14,6,0,28,193,131,6,3,0,24,225,131,14,3,0,48,241,131,30,3,63,152,56,254,24,3,255,248,24,124,48,1,224,240,28,0,112,0,0,64,12,0,96,0,0,0,12,0,96,0,0,0,12,254,96,0,0,0,15,255,224,0,0,0,3,131,128,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,128,0,0,0,1,131,224,0,0,0,7,255,224,0,0,0,6,254,96,0,0,0,6,0,96,0,0,0,6,0,48,0,0,0,6,0,24,0,0,0,12,62,28,0,0,0,12,127,15,0,0,0,24,65,135,0,0,0,56,193,131,0,0,0,112,192,199,0,0,0,96,193,143,0,0,0,120,97,140,0,0,0,60,127,12,0,0,0,12,62,24,0,0,0,6,0,24,0,0,0,3,0,24,0,0,240,3,128,24,0,1,255,115,63,248,0,1,159,255,255,240,0,1,128,141,224,64,0,3,128,24,64,128,0,7,0,24,3,192,128,6,31,12,7,255,224,30,63,140,6,127,240,60,112,198,6,0,48,48,96,199,14,0,96,48,96,195,156,0,112,60,96,193,152,124,48,12,96,193,248,254,24,12,63,135,241,195,24,6,31,12,193,131,30,6,0,28,225,131,14,3,0,56,241,131,6,6,0,48,49,131,14,7,127,48,16,254,30,3,255,240,24,124,48,1,129,240,12,0,112,0,0,128,12,0,224,0,0,0,24,0,192,0,0,0,31,252,192,0,0,0,15,255,192,0,0,0,2,7,128,0,0,0,0,2,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,128,0,0,0,0,7,192,0,0,0,7,126,192,0,0,0,15,252,192,0,0,0,12,128,224,0,0,0,12,0,48,0,0,0,14,0,24,0,0,0,12,62,31,0,0,0,12,127,15,0,0,0,24,97,131,0,0,0,24,193,135,0,0,0,56,192,206,0,0,0,112,192,140,0,0,0,96,97,140,0,0,0,60,127,12,0,0,0,60,62,24,0,0,0,6,0,24,0,0,16,3,0,12,0,0,248,3,128,220,0,0,255,17,159,248,0,0,207,253,223,48,0,1,192,236,240,0,0,3,128,12,112,192,0,3,0,12,3,224,0,30,31,12,3,124,224,62,63,140,3,63,240,48,97,198,7,1,184,48,96,198,14,0,48,60,96,199,28,0,48,12,96,195,248,124,48,12,96,193,240,254,56,12,59,131,193,131,24,6,31,15,225,131,24,6,0,30,113,131,28,6,0,56,49,131,14,14,64,112,49,131,6,7,252,96,16,254,30,3,254,96,24,124,60,0,3,224,24,0,112,0,3,192,24,0,224,0,0,0,59,1,192,0,0,0,31,249,128,0,0,0,14,253,128,0,0,0,0,15,128,0,0,0,0,6,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,0,0,15,128,0,0,0,0,61,128,0,0,0,15,249,192,0,0,0,15,192,224,0,0,0,24,0,112,0,0,0,28,0,30,0,0,0,12,63,15,0,0,0,12,127,131,0,0,0,24,225,135,0,0,0,24,193,142,0,0,0,24,192,204,0,0,0,56,192,140,0,0,0,112,97,140,0,0,0,48,127,12,0,0,0,60,62,12,0,0,0,62,0,12,0,0,28,7,0,14,0,0,124,3,192,252,0,0,110,0,207,248,0,0,103,252,207,0,0,1,224,252,124,0,0,3,128,38,120,240,0,31,0,6,1,240,0,30,30,12,1,158,0,48,63,140,3,159,240,56,113,198,7,1,248,28,96,198,14,0,24,12,96,198,124,0,24,12,96,199,120,124,48,12,96,195,192,254,56,12,59,129,225,131,24,6,31,15,113,131,24,12,0,31,49,131,24,12,0,62,49,131,28,15,192,112,49,131,14,7,248,224,24,254,6,2,60,192,24,124,60,0,7,192,48,0,124,0,7,128,48,0,224,0,0,0,63,1,192,0,0,0,31,243,128,0,0,0,0,243,0,0,0,0,0,31,0,0,0,0,0,30,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,31,0,0,0,0,0,31,0,0,0,0,0,123,0,0,0,0,9,241,192,0,0,0,15,128,224,0,0,0,31,0,62,0,0,0,56,0,30,0,0,0,24,62,3,0,0,0,12,127,7,0,0,0,8,225,142,0,0,0,24,193,140,0,0,0,24,192,204,0,0,0,24,192,140,0,0,0,24,97,140,0,0,0,48,127,12,0,0,0,48,62,14,0,0,0,62,0,6,0,0,30,31,0,126,0,0,62,3,192,252,0,0,55,1,231,192,0,0,115,192,103,0,0,1,224,252,62,0,0,15,128,62,60,120,0,31,0,3,0,248,0,24,30,7,0,206,0,56,63,134,3,207,128,28,113,198,7,129,248,12,96,198,62,0,248,12,96,198,124,0,12,12,96,198,96,124,28,12,96,198,96,254,24,12,59,135,113,199,24,28,31,3,49,131,24,24,0,31,49,131,24,29,0,62,49,131,24,15,192,124,49,131,28,4,249,224,48,254,14,0,57,128,112,124,12,0,15,128,96,0,124,0,15,0,62,0,248,0,0,0,63,3,192,0,0,0,19,231,128,0,0,0,0,230,0,0,0,0,0,62,0,0,0,0,0,60,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,62,0,0,0,0,0,62,0,0,0,0,0,119,0,0,0,0,1,227,192,0,0,0,11,192,252,0,0,0,31,0,126,0,0,0,62,0,6,0,0,0,48,62,6,0,0,0,56,127,14,0,0,0,24,225,140,0,0,0,24,193,140,0,0,0,24,192,204,0,0,0,24,192,140,0,0,0,8,97,140,0,0,0,28,127,6,0,0,0,56,30,3,0,0,0,56,0,30,0,0,15,31,0,126,0,0,31,15,192,224,0,0,27,128,243,192,0,0,121,192,51,0,0,15,224,240,31,0,0,15,128,62,30,60,0,24,0,31,0,124,0,24,30,3,0,230,0,12,63,131,3,231,128,12,113,198,63,129,200,12,96,198,62,0,248,12,96,198,96,0,124,12,96,198,96,124,12,12,96,198,48,254,28,28,51,134,49,195,24,24,31,7,49,131,24,26,0,3,49,131,24,31,0,30,49,131,24,15,192,126,49,131,24,0,241,224,112,254,24,0,51,128,96,124,28,0,63,0,124,0,12,0,30,0,62,0,248,0,0,0,63,3,248,0,0,0,3,207,128,0,0,0,0,206,0,0,0,0,0,124,0,0,0,0,0,120,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,120,0,0,0,0,0,124,0,0,0,0,0,110,0,0,0,0,1,231,248,0,0,0,3,128,252,0,0,0,31,0,46,0,0,0,62,0,14,0,0,0,56,62,12,0,0,0,48,127,12,0,0,0,56,97,140,0,0,0,24,192,140,0,0,0,24,192,204,0,0,0,24,192,142,0,0,0,24,97,135,0,0,0,12,127,3,0,0,0,28,62,7,0,0,0,24,0,30,0,0,7,25,0,60,0,0,15,143,192,224,0,0,13,135,249,192,0,6,124,224,121,128,0,7,224,240,15,128,0,13,128,56,15,30,0,28,0,31,0,62,0,12,30,15,0,115,0,14,63,129,159,227,128,12,113,195,191,1,192,12,96,199,54,0,248,12,64,198,48,0,124,12,96,198,56,124,60,28,96,198,24,254,6,48,59,134,49,195,30,24,31,14,49,131,24,30,0,6,49,129,24,31,0,6,49,131,24,1,192,126,241,199,24,0,227,252,192,254,24,0,103,128,96,124,56,0,126,0,124,0,24,0,60,0,62,0,152,0,0,0,7,1,248,0,0,0,3,143,240,0,0,0,1,158,0,0,0,0,0,248,0,0,0,0,0,240,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,112,0,0,0,0,0,248,0,0,0,0,0,223,48,0,0,0,1,207,248,0,0,0,3,128,220,0,0,0,7,0,12,0,0,0,30,0,28,0,0,0,60,62,24,0,0,0,48,127,140,0,0,0,96,225,140,0,0,0,120,192,140,0,0,0,24,192,206,0,0,0,24,192,135,0,0,0,24,97,131,0,0,0,12,127,7,0,0,0,12,30,31,0,0,0,12,0,60,0,0,3,12,0,112,0,0,3,207,192,224,0,2,30,231,252,192,0,7,252,98,62,192,0,15,224,112,7,192,0,12,0,56,7,14,0,6,0,28,0,31,128,6,31,15,12,249,128,14,63,143,31,249,128,12,113,193,187,1,192,12,96,195,176,0,224,12,64,199,24,0,120,60,96,198,24,124,60,48,96,198,24,254,30,48,59,134,49,199,6,30,31,12,49,131,14,30,0,12,113,129,28,3,0,14,225,131,24,1,192,110,193,199,24,0,199,252,192,254,24,0,207,152,120,124,48,0,252,0,124,0,48,0,120,0,14,0,24,0,0,0,7,1,184,0,0,0,3,31,240,0,0,0,3,190,96,0,0,0,1,240,0,0,0,0,0,224,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,0,0,0,0,1,240,32,0,0,0,1,255,240,0,0,0,1,159,248,0,0,0,3,128,152,0,0,0,7,0,24,0,0,0,6,0,24,0,0,0,28,62,24,0,0,0,60,127,12,0,0,0,112,97,140,0,0,0,96,192,142,0,0,0,120,192,199,0,0,0,56,192,131,0,0,0,8,97,131,0,0,0,12,127,15,0,0,0,12,62,30,0,0,0,6,0,24,0,0,0,6,0,112,0,0,1,238,64,96,0,3,223,247,254,96,0,7,255,35,255,224,0,6,96,112,3,224,0,6,0,56,1,6,0,7,0,24,0,7,128,6,31,12,15,127,192,14,63,143,159,248,192,12,113,199,153,1,192,12,96,193,156,0,224,60,64,195,156,0,112,48,96,199,24,124,56,48,96,198,56,254,30,60,51,142,49,199,6,30,31,12,113,131,6,6,0,28,225,129,14,3,128,24,193,131,28,1,128,12,193,199,24,1,143,252,240,254,56,1,159,248,120,124,48,1,248,48,28,0,112,0,112,0,14,0,48,0,0,0,7,1,48,0,0,0,2,63,240,0,0,0,7,127,224,0,0,0,3,192,192,0,0,0,0,192,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,224,224,0,0,0,3,255,240,0,0,0,3,63,184,0,0,0,3,0,48,0,0,0,7,0,48,0,0,0,6,0,24,0,0,0,12,62,24,0,0,0,28,127,12,0,0,0,120,97,143,0,0,0,96,192,135,0,0,0,96,192,195,0,0,0,120,193,131,0,0,0,60,97,143,0,0,0,12,127,12,0,0,0,12,62,24,0,0,0,6,0,24,0,0,0,7,0,48,0,0,192,230,0,48,0,3,255,247,127,48,0,3,127,187,255,240,0,3,0,49,129,192,0,3,0,56,0,0,0,3,0,28,3,3,128,6,31,12,15,255,224,4,63,142,13,254,224,12,113,199,140,0,192,60,96,195,140,0,224,48,64,193,156,0,112,48,96,199,152,124,48,60,96,199,144,254,24,28,57,134,113,135,30,6,31,12,241,131,6,6,0,28,193,131,6,3,0,24,193,131,14,1,128,24,241,131,28,3,63,152,48,254,24,3,255,248,24,124,48,1,224,112,28,0,112,0,64,0,14,0,96,0,0,0,6,0,96,0,0,0,14,126,96,0,0,0,15,255,224,0,0,0,3,129,128,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,128,0,0,0,1,129,224,0,0,0,7,255,240,0,0,0,6,255,96,0,0,0,6,0,96,0,0,0,6,0,48,0,0,0,6,0,56,0,0,0,12,63,24,0,0,0,12,127,143,0,0,0,24,225,143,0,0,0,120,192,131,0,0,0,96,192,195,0,0,0,96,193,143,0,0,0,120,97,140,0,0,0,60,127,12,0,0,0,12,62,24,0,0,0,6,0,24,0,0,0,7,0,48,0,0,224,35,0,24,0,1,255,243,63,184,0,1,191,251,255,240,0,1,128,153,224,64,0,3,128,24,64,0,0,3,0,24,3,193,128,6,30,12,7,255,224,30,63,140,6,127,112,60,113,198,6,0,96,48,96,199,142,0,96,48,64,195,156,0,112,60,96,193,152,124,48,28,96,199,248,254,24,12,51,135,241,195,24,6,31,12,193,131,30,6,0,28,193,131,6,3,0,56,241,131,6,3,0,48,49,195,30,7,127,48,48,254,60,3,255,240,24,124,48,1,193,240,28,0,112,0,0,192,12,0,224,0,0,0,12,0,192,0,0,0,29,252,192,0,0,0,15,255,192,0,0,0,3,7,128,0,0,0,0,2,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,128,0,0,0,0,7,192,0,0,0,3,254,224,0,0,0,15,252,96,0,0,0,12,192,96,0,0,0,12,0,112,0,0,0,6,0,24,0,0,0,12,62,31,0,0,0,12,127,15,0,0,0,24,225,131,0,0,0,24,192,131,0,0,0,120,192,199,0,0,0,96,193,140,0,0,0,96,97,140,0,0,0,60,127,12,0,0,0,60,62,24,0,0,0,6,0,24,0,0,48,7,0,24,0,0,248,3,128,220,0,0,255,49,159,248,0,0,207,249,191,112,0,1,192,205,240,0,0,3,128,12,32,192,0,7,0,12,3,224,0,14,30,12,3,126,224,62,63,140,3,63,240,48,97,198,7,1,48,48,96,198,14,0,48,60,96,199,28,0,48,28,96,195,248,124,48,12,96,193,240,254,24,12,51,135,193,131,24,6,31,15,193,131,24,6,0,28,241,131,30,6,0,56,49,131,6,6,64,112,49,131,6,7,254,96,48,254,30,3,255,96,24,124,60,1,3,224,24,0,112,0,1,128,24,0,224,0,0,0,25,129,192,0,0,0,31,249,128,0,0,0,14,253,128,0,0,0,0,15,128,0,0,0,0,6,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,128,0,0,0,0,15,128,0,0,0,6,124,192,0,0,0,15,248,192,0,0,0,15,192,224,0,0,0,24,0,48,0,0,0,12,0,30,0,0,0,12,62,15,0,0,0,12,127,3,0,0,0,24,225,131,0,0,0,24,192,135,0,0,0,24,192,204,0,0,0,56,193,140,0,0,0,112,97,140,0,0,0,48,127,12,0,0,0,60,30,24,0,0,0,62,0,12,0,0,24,7,0,12,0,0,124,3,192,252,0,0,110,0,207,248,0,0,231,252,222,16,0,1,192,252,248,0,0,3,128,6,56,224,0,31,0,14,1,240,0,30,30,12,1,188,32,56,63,140,3,159,240,48,113,198,7,1,248,56,96,198,14,0,24,12,96,198,124,0,56,12,96,199,120,124,48,12,96,195,192,254,24,12,59,129,193,131,24,6,31,15,241,131,24,14,0,31,49,131,24,12,0,56,49,131,28,15,192,112,49,131,6,7,248,224,48,254,6,3,60,192,24,124,60,0,7,192,56,0,124,0,7,192,48,0,224,0,0,0,63,129,192,0,0,0,31,243,128,0,0,0,8,251,0,0,0,0,0,31,0,0,0,0,0,14,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,0,0,0,0,0,31,0,0,0,0,0,57,128,0,0,0,12,241,192,0,0,0,15,128,224,0,0,0,31,0,62,0,0,0,24,0,30,0,0,0,28,62,3,0,0,0,12,127,7,0,0,0,24,97,134,0,0,0,24,192,140,0,0,0,24,192,204,0,0,0,24,193,140,0,0,0,56,97,140,0,0,0,48,127,12,0,0,0,48,62,12,0,0,0,62,0,6,0,0,28,31,0,110,0,0,62,3,192,252,0,0,55,0,231,216,0,0,115,192,103,0,0,1,224,252,124,0,0,15,128,62,60,248,0,31,0,3,0,248,0,30,30,6,0,220,0,56,63,142,3,207,176,24,97,198,7,3,248,12,96,198,62,0,248,12,96,198,124,0,28,12,96,198,96,124,24,12,96,199,224,254,24,12,63,131,241,135,24,12,31,3,49,131,24,28,0,31,49,131,24,29,0,63,49,131,24,15,192,112,49,131,28,7,248,224,48,254,14,0,57,128,48,124,12,0,15,128,112,0,124,0,15,128,54,0,248,0,0,0,63,129,192,0,0,0,27,227,128,0,0,0,0,118,0,0,0,0,0,62,0,0,0,0,0,62,0,0,0,0,0,0,0}
};

const uint8_t STARTUP_FRAME_COUNT = sizeof(frames_startup) / sizeof(frames_startup[0]);

// --- Animation control ---
unsigned long animLastMillis0 = 0;
uint8_t animFrameIdx0 = 0;
unsigned long startupLastMs = 0;
uint8_t startupFrameIdx = 0;

// --- Time setting function ---
void setupTime() {
  long offsetSeconds = UTC_OFFSET * 3600;
  long dstOffset = 0;

  configTime(offsetSeconds, 0, "pool.ntp.org", "time.nist.gov");
  unsigned long tstart = millis();
  // waiting until time() returns a reasonable value (e.g., > 1600000000) – adjust as needed
  time_t now;
  do {
    now = time(nullptr);
    drawStartupFrame(); // still animating the screen
    yield();
    delay(10); // short pause to avoid 100% CPU usage
  } while (now < 100000 && (millis() - tstart) < 10000); // timeout ex. 10s

  // time_t now = time(nullptr);
  struct tm tmNow;
  localtime_r(&now, &tmNow);
  int month = tmNow.tm_mon + 1;

  if (strcmp(DST_REGION, "EU") == 0) {
    if (month > 3 && month < 10) dstOffset = 3600;
  } else if (strcmp(DST_REGION, "US") == 0) {
    if (month > 3 && month < 11) dstOffset = 3600;
  }

  configTime(offsetSeconds + dstOffset, 0, "pool.ntp.org", "time.nist.gov");
}

void blinkLED() {
  digitalWrite(LED_PIN, LOW);   // turn on LED
  delay(100);
  digitalWrite(LED_PIN, HIGH);  // turn off LED
}

  // draws the start frame at the center of the screen
void drawStartupFrame() {
  unsigned long now = millis();
  if (now - startupLastMs >= STARTUP_FRAME_DELAY) {
    startupLastMs = now;
    startupFrameIdx = (startupFrameIdx + 1) % STARTUP_FRAME_COUNT;
  }

  display.clearDisplay();

  // centering 48x48 on 128x64
  int x = (SCREEN_WIDTH - STARTUP_W) / 2;   // = 40
  int y = (SCREEN_HEIGHT - STARTUP_H) / 2;  // = 8

  display.drawBitmap(x, y, frames_startup[startupFrameIdx], STARTUP_W, STARTUP_H, SSD1306_WHITE);
  display.display();
}

// --- Function fetching data from the API ---
void fetchStats() {
  WiFiClientSecure client;
  client.setInsecure();
  HTTPClient http;

  if (http.begin(client, apiURL)) {
    int httpCode = http.GET();
    if (httpCode == HTTP_CODE_OK) {
      String payload = http.getString();
      Serial.println(payload);

      // --- Merge JSON into an array ---
      String json1, json2, json3;
      int firstNL = payload.indexOf('\n');
      int secondNL = payload.indexOf('\n', firstNL + 1);
      if (firstNL > 0 && secondNL > 0) {
        json1 = payload.substring(0, firstNL);
        json2 = payload.substring(firstNL + 1, secondNL);
        json3 = payload.substring(secondNL + 1);
      }
      String jsonArray = "[" + json1 + "," + json2 + "," + json3 + "]";

      // --- Parsing ---
      StaticJsonDocument<4096> doc;
      DeserializationError error = deserializeJson(doc, jsonArray);
      if (error) {
        Serial.print("Błąd JSON: ");
        Serial.println(error.c_str());
        http.end();
        return;
      }

      // --- Data from all 3 objects ---
      usersCount = doc[0]["Users"] | 0;
      workersCount = doc[0]["Workers"] | 0;
      idleCount = doc[0]["Idle"] | 0;
      disconnectedCount = doc[0]["Disconnected"] | 0;

      hashrate1m = doc[1]["hashrate1m"].as<String>();
      hashrate5m = doc[1]["hashrate5m"].as<String>();
      hashrate15m = doc[1]["hashrate15m"].as<String>();
      hashrate1hr = doc[1]["hashrate1hr"].as<String>();
      hashrate6hr = doc[1]["hashrate6hr"].as<String>();
      hashrate1d = doc[1]["hashrate1d"].as<String>();
      hashrate7d = doc[1]["hashrate7d"].as<String>();

      diff = doc[2]["diff"] | 0.0;
      accepted = doc[2]["accepted"] | 0.0;
      rejected = doc[2]["rejected"] | 0.0;
      bestshare = doc[2]["bestshare"] | 0.0;
      SPS1m = doc[2]["SPS1m"] | 0.0;
      SPS5m = doc[2]["SPS5m"] | 0.0;
      SPS15m = doc[2]["SPS15m"] | 0.0;
      SPS1h = doc[2]["SPS1h"] | 0.0;
    }
    http.end();
  }
}

void fetchUserStats() {
  WiFiClientSecure client;
  client.setInsecure();
  HTTPClient http;

  if (http.begin(client, userApiURL)) {
    int httpCode = http.GET();
    if (httpCode == HTTP_CODE_OK) {
      String payload = http.getString();
      Serial.println(payload);

      StaticJsonDocument<4096> doc;
      DeserializationError error = deserializeJson(doc, payload);
      if (error) {
        Serial.print("Błąd JSON user: ");
        Serial.println(error.c_str());
        http.end();
        return;
      }

      u_hashrate1m = doc["hashrate1m"].as<String>();
      u_hashrate5m = doc["hashrate5m"].as<String>();
      u_hashrate1hr = doc["hashrate1hr"].as<String>();
      u_hashrate1d = doc["hashrate1d"].as<String>();
      u_hashrate7d = doc["hashrate7d"].as<String>();
      u_lastshare  = doc["lastshare"] | 0;
      u_workers    = doc["workers"] | 0;
      u_shares     = doc["shares"] | 0.0;
      u_bestshare  = doc["bestshare"] | 0.0;
      u_bestever   = doc["bestever"] | 0.0;
      u_authorised = doc["authorised"] | 0;
    }
    http.end();
  }
}

// --- Function drawing pages ---
void drawPage(int page) {
  display.clearDisplay();
  display.setTextSize(1);
  display.setTextColor(SSD1306_WHITE);

  char buf[20];
  time_t t = time(nullptr);
  struct tm timeinfo;
  localtime_r(&t, &timeinfo);

  if (page == 0) {

    display.setTextSize(2);
    display.setFont(&Org_01);
    display.setCursor(21, 12);
    display.println("NerdMiner");
    display.drawLine(0, 21, SCREEN_WIDTH, 21, SSD1306_WHITE);
    display.drawBitmap(5, 30, frames_clock[animFrameIdx0], CLOCK_W, CLOCK_H, SSD1306_WHITE);

    strftime(buf, sizeof(buf), "%H:%M", &timeinfo);
    display.setCursor(52, 55);
    display.setTextSize(2);
    display.println(buf);

    strftime(buf, sizeof(buf), "%d-%m-%Y", &timeinfo);
    display.setTextSize(1);
    display.setCursor(52, 39);
    display.println(buf);

  } else if (page == 1) {

    display.setTextSize(2);
    display.setFont(&Org_01);
    display.setCursor(0, 11);
    display.setTextWrap(0);
    display.setCursor(21, 11);
    display.println("NerdMiner");
    display.drawRect(0, 22, 128, 42, 1);
    display.setTextSize(1);
    display.setCursor(0, 30);
    display.setTextWrap(0);
    display.setCursor(24, 33);
    display.println("YOUR HASHRATE:");
    display.setTextSize(2);
    display.setTextWrap(0);
    display.setCursor(22, 50);
    display.println(splitNumberUnit(u_hashrate1m) + "H/s");

  } else if (page == 2) {

    display.setTextSize(2);
    display.setFont(&Org_01);
    display.setCursor(0, 11);
    display.setTextWrap(0);
    display.setCursor(13, 11);
    display.println("Pool Stats");
    display.drawRect(0, 22, 128, 42, 1);
    display.setTextSize(1);
    display.setCursor(0, 34);
    display.setTextSize(1);
    display.drawBitmap(5, 27, frames_pool[animFrameIdx0], POOL_W, POOL_H, SSD1306_WHITE);
    display.setCursor(45, 35);
    display.println("USERS: " + String(usersCount));
    display.setCursor(45, 45);
    display.println("WORKERS: " + String(workersCount));
    display.setCursor(45, 55);
    display.println("--> " + splitNumberUnit(hashrate1m) + "H/s");

  } else if (page == 3) {

    display.setTextSize(2);
    display.setFont(&Org_01);
    display.setCursor(0, 11);
    display.setTextWrap(0);
    display.setCursor(10, 11);
    display.println("Your Stats");
    display.drawRect(0, 22, 128, 42, 1);
    display.setTextSize(1);
    display.setCursor(0, 34);
    display.setTextSize(1);
    display.drawBitmap(5, 27, frames_user[animFrameIdx0], USER_W, USER_H, SSD1306_WHITE);
    display.setCursor(45, 35);
    display.println("WORKERS: " + String(u_workers));
    display.setCursor(45, 45);
    display.println("SHARES: " + String(u_shares, 0));
    display.setCursor(45, 55);
    display.println("BEST: " + String(u_bestshare, 2));

  }
  display.display();
}

// --- Setup ---
void setup() {
  Serial.begin(115200);

  // --- OLED ---
  Wire.begin(OLED_SDA, OLED_SCL);
  if (!display.begin(SSD1306_SWITCHCAPVCC, 0x3C)) {
    Serial.println(F("SSD1306 allocation failed"));
    for (;;);
  }
  display.clearDisplay();
  display.display();

  // --- LED ---
  pinMode(LED_PIN, OUTPUT);
  digitalWrite(LED_PIN, HIGH); // disabled at startup

  // --- WiFi ---
  WiFi.begin(WIFI_SSID, WIFI_PASS);

  // animate until connected (without blocking delay)
  Serial.print("Connecting to WiFi");
  while (WiFi.status() != WL_CONNECTED) {
    // animate frames
    drawStartupFrame();

    // print dots every 500ms (non-blocking)
    static unsigned long dotLast = 0;
    if (millis() - dotLast >= 500) {
      Serial.print(".");
      dotLast = millis();
    }

    // allow WiFi threads to run
    yield();
  }
  Serial.println("\nWiFi connected");

  setupTime();
  fetchStats();
  fetchUserStats();
  blinkLED();

}

// --- Loop ---
void loop() {
  unsigned long now = millis();
  if (now - lastSwitch > pageInterval) {
    lastSwitch = now;
    currentPage++;
    if (currentPage > 3) currentPage = 0;
    drawPage(currentPage);
  }

    // refreshing animations every ~42ms
  static unsigned long lastDraw = 0;
  if (now - lastDraw >= 42) {
    lastDraw = now;

    if (currentPage == 0) {
      if (now - animLastMillis0 >= CLOCK_FRAME_DELAY) {
        animLastMillis0 = now;
        animFrameIdx0 = (animFrameIdx0 + 1) % CLOCK_FRAME_COUNT;
      }
    }
    if (currentPage == 2) {
      if (now - animLastMillis0 >= POOL_FRAME_DELAY) {
        animLastMillis0 = now;
        animFrameIdx0 = (animFrameIdx0 + 1) % POOL_FRAME_COUNT;
      }
    }
    if (currentPage == 3) {
      if (now - animLastMillis0 >= USER_FRAME_DELAY) {
        animLastMillis0 = now;
        animFrameIdx0 = (animFrameIdx0 + 1) % USER_FRAME_COUNT;
      }
    }

    // draw the current page (drawPage uses animFrameIdx0)
    drawPage(currentPage);
  }

  static unsigned long lastFetch = 0;
  if (millis() - lastFetch > 60000) { // refreshing every minute
    lastFetch = millis();
    fetchStats();
    fetchUserStats();
    blinkLED();
  }
}